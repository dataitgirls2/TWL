# 180906

## 통계스터디 - 회귀분석

### **회귀분석**, 머신러닝의 근간

- 가장 쉬운 머신러닝의 종류
- 현실세계의 데이터들을 모아서 예측 모형을 만들 때, 단순선형 회귀를 이용해서 예측하기에는 너무 복잡했다.
- 이론적/학문적인 가정들이 맞아야 회귀분석이 잘 맞는데, 현실은 절대 그러지 않음.
- 단순한 모형의 한계를 느껴서 여러가지 머신러닝 방법으로 뻗어나갔음.

통계학적인 문제 해결 방법을 가장 통계적으로 잘 해결해주는 분석이어서 회귀분석이 통계학의 꽃이라고 불리우게 됨.

현재의 상황을 간단하게 표현하고 그것을 통해서 미래를 예측해 줌.

- 표본 회귀선을 만들어서 실제 회귀선을 예측.
- 복잡한 현실 상황을 관계식을 통해 간단하게 설명해 줌

---

### 회귀분석의 유래

#### 갈톤의 발견

아버지의 키가 큰 집단에서 태어난 자식들의 키를 보는 중, 어떠한 사실을 발견

- 아버지의 키가 큰 집단의 평균 키보다는 자식의 키평균이 작았고, 아버지들의 키 평균이 작으면 자식들의 평균 키가 컸다.
  - 조건부 평균에 대한 문제: 특정 조건이 개입되어있는 평균
- 사람들간의 닮음에 대한 물음?
- 아버지가 크면 자식들도 크고, 큰 자식들이 또 큰 자식들을 낳는 것이 아니고, 대가 이어질 수록 다시 원래의 키로 "회귀"한다는 사실을 발견함

#### 회귀(Regression)의 뜻

- 이전 발전단계로 돌아감.
- 극단적인 상황으로 가지 않고 평균의 상태를 유지하려는 성질을 가짐.(평균으로 회귀함)



### 회귀분석이란?

언제나 오차를 감안한 확률적인 관계성을 나타남.

- 실제로 정확한 관계식은 보기 힘들다.
- 모 회귀선을 추정하기 위한 표본 회귀선

#### 상관분석

어떤 변수와 다른 변수간의 상관관계를 분석하는 것.

- 상관관계가 높으면 회귀분석이 잘 적용됨.
- 산포도를 확인해 보며 상관관계를 보아, 회귀분석을 결정할 수 있음.
- 변수들의 관계가 선형인지, 비 선형인지
- 변수들의 관계가 양의 관계인지, 음의 관계인지 등
- 선형 관계를 가지고 있을 경우에 회귀분석을 적용하기가 용이하고 정확도가 올라감

#### 모집단 회귀모형

(그림 2) 모회귀모형을 안다고 가정했을 때,

- 기온이 27도인 날, 판매량의 평균을 알고 싶은 것
- E(Y|X) = b0 + b1X

#### 표본단순선형회귀분석

보통의 회귀분석에서 절편은 결과 해석에 그렇게 중요한 부분이 아님. 기울기가 중요한 요소.

##### 회귀선을 그리는 방법

- 최소제곱법
  - 잔차제곱합이 최소가 되는 직선
  - 예측값과 실제값을 뺀 것(error)을 제곱해서 더한 것이 최소인 직선을 그림.
- 다른 방법도 있지만, 수리적으로 어려운 방법들, 혹은 굳이 다른 방법을 사용하지는 않음.

**회귀계수는 독립변수가 한 단위 변함에 따라 종속변수에 미치는 영향력 크기를 의미하기 때문에 매우 중요한 값이다. 그러나 회귀상수는 적합한 회귀선을 추정하기 위한 절편에 해당되므로 그다지 중요한 의미를 갖지 않는다.**

#### 회귀분석에서의 가정

회귀식이 최적의 회귀식인가? 를 판단하는 척도가 됨. 만약에 가정들을 충족시키지 않는다면 회귀분석 이외의 더 적당한 다른 분석을 사용하는 게 선호될 수 있음. 조금 더 복잡한 모델이 필요할 수 있음을 의미.

1. error의 기대값이 0

   - 오차를 다 더했을 때 0이라는 이야기는 회귀선이 데이터들의 중간을 지나간다는 것.
   - 같은 x값을 가지는 데이터라면 편향 없이 그 데이터들의 중간을 지남

2. 오차에 대한 가정

   - **정규성**: 오차는 정규분포를 따름
     - y는 정규분포를 따름.
     - 각 x값에 때하여 모집단에서의 y값은 정규분포를 따름.
     - 정규분포는 평균 주변이 가장 높은 확률을 가지기 때문에 어떠한 데이터들이 평균에서 가장 높은 확률을 가지는 것을 가정해야 그린 회귀식이 의미를 가짐. 평균을 가지고 데이터들을 가장 잘 설명할 수 있어야 하니까.

   - **등분산성**: y값 분포의 분산은 모든 x값에서 같다
     - 오차는 모든 x값에서 동일한 분산을 가짐.
     - y의 평균에 대한 예측선을 그리는 것이기 떄문에 y의 분산에는 영향을 덜 미친다고 가정하는 것. 만약에 분산에까지 영향을 미친다면 다른 모형을 적용시켜야 함.
     - 조건부 평균에 의해 에러가 계산되기 때문에 결국 y의 분산이 됨.
   - 오차항의 **자기상관**이 없어야 함
     - 오차끼리 서로 상관관계가 없음.
     - 랜덤하게 표본이 뽑히지 않은 것. 조사단계부터 제대로 이루어지지 않음.
     - 오차항들이 트렌드를 가지고 있다는 것은 랜덤성이 떨어지기 때문에 없애줘야 함.
     - 연속된 오차항들을 순서대로 찍어봤을 때 error(i,j)의 트렌드
     - 예를들면, 자료의 수집 순서, 방법에 따라 이전 오차항이 다음 오차항에게 영향을 미칠 수도 있음.

3. error와 x간에 상관관계가 없어야 함.

   - 잔차분석을 통해 error에 대해 확인해 봄.

   - 잔차와 x의 scatter plot, p-p plot, Q-Q plot 등으로 확인해 볼 수 있음.

4. 독립변수(x)간 상호관계가 없어야 함.

   - **다중공선성**이 없어야 함
   - 독립변수들 끼리 상관관계가 높은 변수들이 모형에 포함될 경우, 그 의미가 왜곡되거나 불안정해질 수 있음.